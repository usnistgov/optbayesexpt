
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Utilities &#8212; OptBayesExpt 1.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="ParticlePDF class" href="particlepdf.html" />

    <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" type="text/css" />
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
    <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />

<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="particlepdf.html" title="ParticlePDF class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OptBayesExpt 1.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="optbayesexpt.html" accesskey="U">optbayesexpt API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Utilities</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-optbayesexpt.obe_utils">
<span id="utilities"></span><h1>Utilities<a class="headerlink" href="#module-optbayesexpt.obe_utils" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="optbayesexpt.obe_utils.MeasurementSimulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">optbayesexpt.obe_utils.</span></span><span class="sig-name descname"><span class="pre">MeasurementSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/optbayesexpt/obe_utils.html#MeasurementSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optbayesexpt.obe_utils.MeasurementSimulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides simulated measurement data</p>
<p>Evaluates the model function and adds noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_function</strong> (<em>func</em>) – Generally the same as the function used
by OptBayesExpt</p></li>
<li><p><strong>true_params</strong> (<em>tuple</em>) – Parameter values, typically the “true values”
of the simulated experiment.</p></li>
<li><p><strong>cons</strong> (<em>tuple</em>) – The constants.</p></li>
<li><p><strong>noise_level</strong> (<em>float</em>) – standard deviation of the added noise.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="optbayesexpt.obe_utils.MeasurementSimulator.simdata">
<span class="sig-name descname"><span class="pre">simdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">setting</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/optbayesexpt/obe_utils.html#MeasurementSimulator.simdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optbayesexpt.obe_utils.MeasurementSimulator.simdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a measurement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>setting</strong> (<em>tuple</em><em> of </em><em>floats</em>) – The setting values</p></li>
<li><p><strong>params</strong> (<em>tuple</em><em> of </em><em>floats</em>) – if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, temporarily used
instead of the initial values. (opt)</p></li>
<li><p><strong>noise_level</strong> (<em>float</em>) – if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, temporarily used instead of
the initial value. (opt)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Simulated measurement value(s)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="optbayesexpt.obe_utils.differential_entropy">
<span class="sig-prename descclassname"><span class="pre">optbayesexpt.obe_utils.</span></span><span class="sig-name descname"><span class="pre">differential_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/optbayesexpt/obe_utils.html#differential_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optbayesexpt.obe_utils.differential_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample of a distribution, estimate the differential entropy.</p>
<p>This code is copied from scipy.stats with reformatted docstrings.  When the module is
loaded, __init__.py attempts to import <code class="docutils literal notranslate"><span class="pre">differential_entropy()</span></code> from scipy.stats, and loads
this version from obe_utils.py if an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> is raised.</p>
<p>Several estimation methods are available using the <cite>method</cite> parameter. By
default, a method is selected based the size of the sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sequence</span></code>) – Samples from a continuous distribution.</p></li>
<li><p><strong>window_length</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional) – <p>Window length for computing Vasicek estimate.
Must be an integer between 1 and half of  the sample size. If <code class="docutils literal notranslate"><span class="pre">None</span></code>
(the default), it uses the heuristic value</p>
<div class="math notranslate nohighlight">
\[\left \lfloor \sqrt{n} + 0.5 \right \rfloor\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the sample size. This heuristic was originally
proposed in <a class="footnote-reference brackets" href="#id9" id="id1">2</a> and has become common in the literature.</p>
</p></li>
<li><p><strong>base</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional) – The logarithmic base to use, defaults to <code class="docutils literal notranslate"><span class="pre">e</span></code> (natural logarithm).</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, optional) – The axis along which the differential entropy is calculated.
Default is 0.</p></li>
<li><p><strong>method</strong> – {‘vasicek’, ‘van es’, ‘ebrahimi’, ‘correa’, ‘auto’}, optional
The method used to estimate the differential entropy from the sample.
Default is <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>.  See Notes for more information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated differential entropy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>entropy (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function will converge to the true differential entropy in the limit</p>
<div class="math notranslate nohighlight">
\[n \to \infty, \quad m \to \infty, \quad \frac{m}{n} \to 0\]</div>
<p>The optimal choice of <code class="docutils literal notranslate"><span class="pre">window_length</span></code> for a given sample size depends on
the (unknown) distribution. Typically, the smoother the density of the
distribution, the larger the optimal value of <code class="docutils literal notranslate"><span class="pre">window_length</span></code> <a class="footnote-reference brackets" href="#id8" id="id2">1</a>.
The following options are available for the <cite>method</cite> parameter.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'vasicek'</span></code> uses the estimator presented in <a class="footnote-reference brackets" href="#id8" id="id3">1</a>. This is one of the
first and most influential estimators of differential entropy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'van</span> <span class="pre">es'</span></code> uses the bias-corrected estimator presented in <a class="footnote-reference brackets" href="#id10" id="id4">3</a>, which
is not only consistent but, under some conditions, asymptotically normal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ebrahimi'</span></code> uses an estimator presented in <a class="footnote-reference brackets" href="#id11" id="id5">4</a>, which was shown
in simulation to have smaller bias and mean squared error than
the Vasicek estimator.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'correa'</span></code> uses the estimator presented in <a class="footnote-reference brackets" href="#id12" id="id6">5</a> based on local linear
regression. In a simulation study, it had consistently smaller mean
square error than the Vasiceck estimator, but it is more expensive to
compute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'auto'</span></code> selects the method automatically (default). Currently,
this selects <code class="docutils literal notranslate"><span class="pre">'van</span> <span class="pre">es'</span></code> for very small samples (&lt;10), <code class="docutils literal notranslate"><span class="pre">'ebrahimi'</span></code>
for moderate sample sizes (11-1000), and <code class="docutils literal notranslate"><span class="pre">'vasicek'</span></code> for larger
samples, but this behavior is subject to change in future versions.</p></li>
</ul>
<p>All estimators are implemented as described in <a class="footnote-reference brackets" href="#id13" id="id7">6</a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id8"><span class="brackets">1</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Vasicek, O. (1976). A test for normality based on sample entropy.
Journal of the Royal Statistical Society:
Series B (Methodological), 38(1), 54-59.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Crzcgorzewski, P., &amp; Wirczorkowski, R. (1999). Entropy-based
goodness-of-fit test for exponentiality. Communications in
Statistics-Theory and Methods, 28(5), 1183-1202.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Van Es, B. (1992). Estimating functionals related to a density by a
class of statistics based on spacings. Scandinavian Journal of
Statistics, 61-72.</p>
</dd>
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Ebrahimi, N., Pflughoeft, K., &amp; Soofi, E. S. (1994). Two measures
of sample entropy. Statistics &amp; Probability Letters, 20(3), 225-234.</p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Correa, J. C. (1995). A new estimator of entropy. Communications
in Statistics-Theory and Methods, 24(10), 2439-2449.</p>
</dd>
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><p>Noughabi, H. A. (2015). Entropy Estimation Using Numerical
Methods. Annals of Data Science, 2(2), 231-241.
<a class="reference external" href="https://link.springer.com/article/10.1007/s40745-015-0045-9">https://link.springer.com/article/10.1007/s40745-015-0045-9</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="optbayesexpt.obe_utils.trace_sort">
<span class="sig-prename descclassname"><span class="pre">optbayesexpt.obe_utils.</span></span><span class="sig-name descname"><span class="pre">trace_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/optbayesexpt/obe_utils.html#trace_sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optbayesexpt.obe_utils.trace_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine measurements at identical settings values</p>
<p>Analyzes input arrays of setttings and corresponding measurement
values, data where settings values may repeat, i. e. more than one
measurement was done at some of the settings.  The function
bins the measurements by setting value and calculates some statistics
for measurments in each bin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>settings</strong> – (ndarray) Setting values</p></li>
<li><p><strong>measurements</strong> – (ndarray) measurement values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple, (sorted_settings, m_average, m_std, n_of_m)</dt><dd><ul class="simple">
<li><p>sorted_settings (list): setting values (sorted, none repeated)</p></li>
<li><p>m_average (list): average measurement value at each setting</p></li>
<li><p>m_sigma (list): standard deviation of measurement values at
each setting</p></li>
<li><p>n_of_m (list): number of measurements at each setting.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Utilities</a><ul>
<li><a class="reference internal" href="#optbayesexpt.obe_utils.MeasurementSimulator"><code class="docutils literal notranslate"><span class="pre">MeasurementSimulator</span></code></a><ul>
<li><a class="reference internal" href="#optbayesexpt.obe_utils.MeasurementSimulator.simdata"><code class="docutils literal notranslate"><span class="pre">simdata()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optbayesexpt.obe_utils.differential_entropy"><code class="docutils literal notranslate"><span class="pre">differential_entropy()</span></code></a></li>
<li><a class="reference internal" href="#optbayesexpt.obe_utils.trace_sort"><code class="docutils literal notranslate"><span class="pre">trace_sort()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="particlepdf.html"
                          title="previous chapter">ParticlePDF class</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/obe_utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="particlepdf.html" title="ParticlePDF class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OptBayesExpt 1.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="optbayesexpt.html" >optbayesexpt API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Utilities</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright National Institute of Standards and Technology.Not subject to copyright in the United States..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>